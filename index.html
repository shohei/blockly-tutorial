<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Blockly demo</title>

    <script src="./blockly_compressed.js"></script>
    <script src="./blocks_compressed.js"></script>
    <script src="./javascript_compressed.js"></script>
    <script src="./python_compressed.js"></script>
    <script src="./msg/js/en.js"></script>

    <script src="./customblocks.js"></script>

    <style>
      body {
        background-color: #fff;
        font-family: sans-serif;
      }
      h1 {
        font-weight: normal;
        font-size: 140%;
      }
      #circle {
        height: 300px;
        width: 300px;
        border-radius: 50%;
        background-color: white;
        border: solid 1px black;
        position: absolute;
        left: 760px;
        top: 110px;
      }
    </style>
  </head>
  <body>

    <p>
    <button onclick="runCode()">Run JavaScript</button>
    </p>

    <div id="blocklyDiv" style="height: 480px; width: 600px;"></div>

    <xml id="toolbox" style="display: none;">
    <category name="Logic">
    <block type="lightswitch">
    <field name="lightcolor">red</field> 
    <field name="switch">on</field> 
    </block> 
    </category>
    </xml>

    <div id="circle"></div>

    <script>
      var workspace = Blockly.inject('blocklyDiv',
      {media: './media',
        toolbox: document.getElementById('toolbox')});

      function runCode(){
        window.LoopTrap = 1000;
        Blockly.JavaScript.INFINITE_LOOP_TRAP = 
        'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';
        var code = Blockly.JavaScript.workspaceToCode(workspace);
        Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
        try {
          eval(code);
          } catch (e) {
          alert(e);
        }
      }
    </script>

  </body>
</html>
